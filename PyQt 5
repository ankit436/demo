import sqlite3

def create_connection():
    return sqlite3.connect('contacts.db')

def initialize_database():
    connection = create_connection()
    cursor = connection.cursor()
    cursor.execute("""
        CREATE TABLE IF NOT EXISTS contacts (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            name TEXT NOT NULL,
            surname TEXT,
            phone_number TEXT NOT NULL,
            email TEXT NOT NULL
        )
    """)
    connection.commit()
    connection.close()

def get_all_contacts():
    connection = create_connection()
    cursor = connection.cursor()
    cursor.execute("SELECT * FROM contacts")
    contacts = cursor.fetchall()
    connection.close()
    return contacts

def get_contact(contact_id):
    connection = create_connection()
    cursor = connection.cursor()
    cursor.execute("SELECT * FROM contacts WHERE id = ?", (contact_id,))
    contact = cursor.fetchone()
    connection.close()
    return contact

def add_contact(name, surname, phone, email):
    connection = create_connection()
    cursor = connection.cursor()
    cursor.execute("INSERT INTO contacts (name, surname, phone_number, email) VALUES (?, ?, ?, ?)",
                   (name, surname, phone, email))
    connection.commit()
    connection.close()

def update_contact(contact_id, name, surname, phone, email):
    connection = create_connection()
    cursor = connection.cursor()
    cursor.execute("UPDATE contacts SET name = ?, surname = ?, phone_number = ?, email = ? WHERE id = ?",
                   (name, surname, phone, email, contact_id))
    connection.commit()
    connection.close()

def delete_contact(contact_id):
    connection = create_connection()
    cursor = connection.cursor()
    cursor.execute("DELETE FROM contacts WHERE id = ?", (contact_id,))
    connection.commit()
    connection.close()
