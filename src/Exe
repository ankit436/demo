import xlwings as xw

# Open the Excel file
wb = xw.Book('your_excel_file.xlsx')

# Specify the sheet
sheet = wb.sheets['Sheet1']

# Get the header row values
header_row = sheet.range('A1').expand('right').value

# Sort the data columns based on the values in the first row
sorted_columns = sorted(header_row)

# Reorder the data based on the sorted columns
sorted_data = [sheet.range((1, header_row.index(col_name) + 1), (sheet.cells.last_cell.row, header_row.index(col_name) + 1)).value for col_name in sorted_columns]

# Clear the existing data
sheet.range((1, 1), (sheet.cells.last_cell.row, len(header_row))).clear()

# Write the sorted data back to the sheet
for col_index, col_data in enumerate(sorted_data):
    sheet.range((1, col_index + 1)).options(transpose=True).value = col_data

# Save the changes
wb.save()

# Close the Excel file
wb.close()
